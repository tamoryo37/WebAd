# 広告運用管理システム - 本番運用ガイド

## システム概要

本システムは、パチンコ店舗の広告運用業務を効率化する統合管理システムです。マルチテナント型BPOサービスとして、複数クライアント企業が安全にデータを管理できます。

## 主要機能

1. **ダッシュボード**: KPI表示、ガントチャート、月次データ
2. **店舗管理**: 店舗情報、画像、月次資料の管理
3. **入稿管理**: キャンペーン作成・編集、進捗管理
4. **未消化管理**: 予算未達成キャンペーンの追跡
5. **広告運用管理**: リアルタイム進捗モニタリング
6. **設定**: バックアップ、通知、操作履歴

## 技術スタック

- **フロントエンド**: React 18 + TypeScript + Vite
- **スタイリング**: Tailwind CSS
- **バックエンド**: Supabase (PostgreSQL + Auth + Storage)
- **認証**: Supabase Auth (Email/Password)

## セキュリティ実装

### 3層セキュリティモデル

1. **テナント分離**: 全テーブルにtenant_idを設定し、RLSで厳格に制御
2. **所有者制御**: 担当者は自身が作成したデータのみ編集可能
3. **メディア別アクセス制御**: 担当メディアのみアクセス可能

### セキュリティ機能

- Row Level Security (RLS) による行レベルアクセス制御
- セキュリティヘッダー (X-Frame-Options, CSP, etc.)
- 入力値バリデーション
- エラーバウンダリ
- ログ記録

## パフォーマンス最適化

- Code splitting（React.lazy）
- Manual chunks設定
- Build optimization
- 画像最適化
- キャッシング戦略

## デプロイメント

### 環境変数の設定

`.env`ファイルを作成し、以下の環境変数を設定してください:

```bash
VITE_SUPABASE_URL=your_supabase_url
VITE_SUPABASE_ANON_KEY=your_supabase_anon_key
```

### ビルドコマンド

```bash
# 依存関係のインストール
npm install

# 型チェック
npm run typecheck

# 本番ビルド
npm run build

# プレビュー
npm run preview
```

### デプロイ先の推奨設定

**Vercel / Netlify 設定例**:

- Build command: `npm run build`
- Output directory: `dist`
- Node version: 18.x以上

## 運用監視

### ログ監視

システムは以下のレベルでログを記録します:

- **ERROR**: エラーが発生した場合（要対応）
- **WARN**: 警告レベルの問題
- **INFO**: 通常の操作ログ
- **DEBUG**: デバッグ情報（開発環境のみ）

### パフォーマンス監視

以下の指標を定期的に確認してください:

- ページロード時間: 2秒以内
- データ取得時間: 1秒以内
- Core Web Vitals (LCP, FID, CLS)

## トラブルシューティング

### よくある問題

**1. ログインできない**
- Supabase接続情報の確認
- ユーザーがusersテーブルに登録されているか確認
- ブラウザのキャッシュをクリア

**2. データが表示されない**
- RLSポリシーの確認
- テナントIDの確認
- ブラウザコンソールでエラーを確認

**3. パフォーマンスが遅い**
- ネットワーク状況の確認
- Supabaseの接続状態確認
- ブラウザの開発者ツールでボトルネック特定

### エラーコード

- `AUTH_ERROR`: 認証エラー - 再ログインが必要
- `PERMISSION_DENIED`: 権限不足 - 管理者に連絡
- `NOT_FOUND`: データが見つからない
- `NETWORK_ERROR`: ネットワーク接続エラー

## サポート

問題が発生した場合は、以下の情報を含めてサポートチームに連絡してください:

1. エラーメッセージ
2. 発生日時
3. 実行していた操作
4. ブラウザとOSのバージョン
5. ユーザーのメールアドレス（個人情報に配慮）

## メンテナンス

### 定期メンテナンス

- **日次**: データベースバックアップの確認
- **週次**: エラーログのレビュー
- **月次**: パフォーマンス指標のレビュー
- **四半期**: セキュリティ監査

### アップデート手順

1. ステージング環境でテスト
2. バックアップの実施
3. メンテナンス告知
4. 本番環境へデプロイ
5. 動作確認
6. ロールバック準備

## セキュリティベストプラクティス

- 定期的なパスワード変更の推奨
- 外部ユーザーには最小限の権限のみ付与
- 操作ログの定期的な確認
- Supabaseダッシュボードでのアクティビティ監視
- 不審なアクセスパターンの早期検知

## ライセンス

本システムは社内利用のみを目的としています。

---

**最終更新日**: 2025年10月7日
